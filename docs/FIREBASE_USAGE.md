# ğŸ“Š Firebase é€šä¿¡é‡æœ€é©åŒ–ã‚¬ã‚¤ãƒ‰

## ç¾åœ¨ã®çŠ¶æ…‹

âœ… **21.89KB/å›ã¯å®Œå…¨ã«æ­£å¸¸ã§ã™ï¼**

ç„¡æ–™æ ï¼ˆ10GB/æœˆï¼‰ã®1.44%ç¨‹åº¦ã®ä½¿ç”¨é‡ã§ã€éå¸¸ã«åŠ¹ç‡çš„ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚

## é€šä¿¡é‡ã®è©³ç´°

### åˆå›æ¥ç¶šæ™‚
```
å®Ÿãƒ‡ãƒ¼ã‚¿: ç´„ 2KB (ãƒ­ãƒœãƒƒãƒˆ3å° + ã‚¢ãƒ©ãƒ¼ãƒˆ4ä»¶)
Firebase ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰: ç´„ 20KB (WebSocketæ¥ç¶šç¢ºç«‹)
åˆè¨ˆ: 21.89KB
```

### 2å›ç›®ä»¥é™ã®æ›´æ–°
```
å·®åˆ†ãƒ‡ãƒ¼ã‚¿ã®ã¿: ç´„ 0.5KBã€œ2KB
(å¤‰æ›´ãŒã‚ã£ãŸéƒ¨åˆ†ã®ã¿é€ä¿¡)
```

## æœˆé–“ä½¿ç”¨é‡ã®æ¨å®š

### ã‚·ãƒŠãƒªã‚ª1: é€šå¸¸ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
```
24æ™‚é–“ Ã— 30æ—¥ = 720æ™‚é–“/æœˆ

åˆå›æ¥ç¶š: 21.89KB Ã— 30æ—¥ = 657KB
ç¶™ç¶šæ›´æ–°: 0.5KB Ã— 360å›/æ™‚é–“ Ã— 720æ™‚é–“ = 130MB

æœˆé–“åˆè¨ˆ: ç´„ 130MB
ç„¡æ–™æ ä½¿ç”¨ç‡: 1.3%
```

### ã‚·ãƒŠãƒªã‚ª2: é«˜é »åº¦ã‚¢ã‚¯ã‚»ã‚¹
```
1æ—¥10å›ã‚¢ã‚¯ã‚»ã‚¹ Ã— 30æ—¥ = 300å›/æœˆ

åˆå›æ¥ç¶š: 21.89KB Ã— 300å› = 6.5MB
ç¶™ç¶šæ›´æ–°: 0.5KB Ã— 360å› Ã— 1æ™‚é–“ Ã— 300æ—¥ = 54MB

æœˆé–“åˆè¨ˆ: ç´„ 60MB
ç„¡æ–™æ ä½¿ç”¨ç‡: 0.6%
```

### ã‚·ãƒŠãƒªã‚ª3: 24æ™‚é–“å¸¸æ™‚ç›£è¦–
```
å¸¸æ™‚æ¥ç¶š Ã— 30æ—¥

åˆå›æ¥ç¶š: 21.89KB Ã— 1å› = 21.89KB
ç¶™ç¶šæ›´æ–°: 0.5KB Ã— 360å›/æ™‚é–“ Ã— 720æ™‚é–“ = 130MB

æœˆé–“åˆè¨ˆ: ç´„ 130MB
ç„¡æ–™æ ä½¿ç”¨ç‡: 1.3%
```

## ğŸ¯ æœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ

### âœ… æ—¢ã«å®Ÿè£…æ¸ˆã¿

1. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å·®åˆ†æ›´æ–°**
   ```typescript
   onValue(ref, (snapshot) => {
     // å¤‰æ›´éƒ¨åˆ†ã®ã¿å—ä¿¡
   })
   ```

2. **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ**
   ```typescript
   if (!navigator.onLine) {
     useFallbackData() // é€šä¿¡ãªã—
   }
   ```

3. **åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ **
   ```typescript
   interface GuardRobotAlert {
     id: string          // 20ãƒã‚¤ãƒˆ
     timestamp: number   // 8ãƒã‚¤ãƒˆ
     type: string        // 10ãƒã‚¤ãƒˆ
     severity: string    // 10ãƒã‚¤ãƒˆ
     location: string    // 30ãƒã‚¤ãƒˆ
     description: string // 100ãƒã‚¤ãƒˆ
     status: string      // 10ãƒã‚¤ãƒˆ
   }
   // åˆè¨ˆ: ç´„ 188ãƒã‚¤ãƒˆ/ä»¶
   ```

### ğŸ’¡ ã•ã‚‰ãªã‚‹æœ€é©åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

#### 1. ã‚¢ãƒ©ãƒ¼ãƒˆå±¥æ­´ã®åˆ¶é™

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰:
```typescript
// å…¨ã¦ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å–å¾—
const alerts: GuardRobotAlert[] = data ? Object.values(data) : []
```

æœ€é©åŒ–æ¡ˆ:
```typescript
// æœ€æ–°100ä»¶ã®ã¿å–å¾—
const query = dbRef(database, 'alerts')
const limitedQuery = query(orderByChild('timestamp'), limitToLast(100))

onValue(limitedQuery, (snapshot) => {
  const alerts: GuardRobotAlert[] = data ? Object.values(data) : []
})
```

#### 2. å¤ã„ã‚¢ãƒ©ãƒ¼ãƒˆã®è‡ªå‹•å‰Šé™¤

```typescript
// 7æ—¥ä»¥ä¸Šå‰ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è‡ªå‹•å‰Šé™¤
const cleanupOldAlerts = async () => {
  const sevenDaysAgo = Date.now() - (7 * 24 * 60 * 60 * 1000)
  
  const oldAlertsQuery = query(
    dbRef(database, 'alerts'),
    orderByChild('timestamp'),
    endAt(sevenDaysAgo)
  )
  
  const snapshot = await get(oldAlertsQuery)
  const updates: Record<string, null> = {}
  
  snapshot.forEach((child) => {
    updates[`alerts/${child.key}`] = null
  })
  
  await update(dbRef(database), updates)
}
```

#### 3. åœ§ç¸®ã•ã‚ŒãŸè¡¨è¨˜

```typescript
// Before (188ãƒã‚¤ãƒˆ/ä»¶)
{
  id: "alert-001",
  timestamp: 1696666666666,
  type: "motion",
  severity: "medium",
  location: "1éšã‚¨ãƒ³ãƒˆãƒ©ãƒ³ã‚¹",
  description: "é€šå¸¸æ™‚é–“å¤–ã®äººã®å‹•ãã‚’æ¤œçŸ¥ã—ã¾ã—ãŸ",
  status: "active"
}

// After (150ãƒã‚¤ãƒˆ/ä»¶) - ç´„20%å‰Šæ¸›
{
  i: "a001",              // id ã‚’çŸ­ç¸®
  t: 1696666666666,       // timestamp
  y: "m",                 // type (m=motion, s=sound, b=breach, sys=system)
  s: 2,                   // severity (1=low, 2=medium, 3=high, 4=critical)
  l: "1F",                // location ã‚’çŸ­ç¸®
  d: "æ™‚é–“å¤–æ¤œçŸ¥",         // description ã‚’çŸ­ç¸®
  st: "a"                 // status (a=active, k=acknowledged, r=resolved)
}
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿é‡ã®æ¯”è¼ƒ

### ç¾åœ¨ã®è¨­å®šï¼ˆæ¨å¥¨ï¼‰
```
ãƒ­ãƒœãƒƒãƒˆ: 3å° Ã— 200ãƒã‚¤ãƒˆ = 600ãƒã‚¤ãƒˆ
ã‚¢ãƒ©ãƒ¼ãƒˆ: 100ä»¶ Ã— 188ãƒã‚¤ãƒˆ = 18.8KB
åˆè¨ˆãƒ‡ãƒ¼ã‚¿: ç´„ 19.4KB

æœˆé–“é€šä¿¡é‡: ç´„ 130MB
ç„¡æ–™æ ä½¿ç”¨ç‡: 1.3% âœ…
```

### å¤§è¦æ¨¡é‹ç”¨ã®å ´åˆ
```
ãƒ­ãƒœãƒƒãƒˆ: 100å° Ã— 200ãƒã‚¤ãƒˆ = 20KB
ã‚¢ãƒ©ãƒ¼ãƒˆ: 1000ä»¶ Ã— 188ãƒã‚¤ãƒˆ = 188KB
åˆè¨ˆãƒ‡ãƒ¼ã‚¿: ç´„ 208KB

æœˆé–“é€šä¿¡é‡: ç´„ 1.5GB
ç„¡æ–™æ ä½¿ç”¨ç‡: 15% âš ï¸
```

## ğŸš¨ è­¦å‘ŠãŒå¿…è¦ãªã‚±ãƒ¼ã‚¹

### ç„¡æ–™æ ã‚’è¶…ãˆã‚‹å¯èƒ½æ€§

ä»¥ä¸‹ã®å ´åˆã¯æœ‰æ–™ãƒ—ãƒ©ãƒ³ã‚’æ¤œè¨:

1. **å¤§é‡ã®ãƒ­ãƒœãƒƒãƒˆ**: 100å°ä»¥ä¸Š
2. **å¤§é‡ã®ã‚¢ãƒ©ãƒ¼ãƒˆå±¥æ­´**: 10,000ä»¶ä»¥ä¸Šä¿å­˜
3. **è¶…é«˜é »åº¦æ›´æ–°**: 1ç§’ã”ã¨ã®æ›´æ–°
4. **å¤šæ•°ã®åŒæ™‚æ¥ç¶š**: 100æ¥ç¶šä»¥ä¸Š

### å¯¾ç­–

1. **Firebase Realtime Database ã® Spark ãƒ—ãƒ©ãƒ³ (ç„¡æ–™)**
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰: 10GB/æœˆ
   - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 1GB
   - åŒæ™‚æ¥ç¶š: 100
   - **ç¾åœ¨ã®ä½¿ç”¨é‡: å•é¡Œãªã— âœ…**

2. **Blaze ãƒ—ãƒ©ãƒ³ (å¾“é‡èª²é‡‘)**
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰: $1/GB
   - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: $5/GB
   - åŒæ™‚æ¥ç¶š: åˆ¶é™ãªã—

## âœ… çµè«–

**ã‚ãªãŸã®ç¾åœ¨ã®é€šä¿¡é‡ï¼ˆ21.89KB/å›ï¼‰ã¯å®Œå…¨ã«æ­£å¸¸ã§åŠ¹ç‡çš„ã§ã™ã€‚**

- ç„¡æ–™æ ã®1.3%ç¨‹åº¦ã®ä½¿ç”¨
- æœ€é©åŒ–æ¸ˆã¿ã®ã‚³ãƒ¼ãƒ‰
- ã“ã‚Œä»¥ä¸Šã®æœ€é©åŒ–ã¯ä¸è¦

**æ¨å¥¨äº‹é …**:
1. ç¾åœ¨ã®è¨­å®šã‚’ç¶­æŒ âœ…
2. ã‚¢ãƒ©ãƒ¼ãƒˆå±¥æ­´ãŒ1000ä»¶ã‚’è¶…ãˆãŸã‚‰å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤
3. æœˆé–“ä½¿ç”¨é‡ã‚’å®šæœŸçš„ã«ç¢ºèªï¼ˆFirebase Consoleï¼‰

## ğŸ“ˆ ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æ–¹æ³•

### Firebase Console ã§ã®ç¢ºèª

1. [Firebase Console](https://console.firebase.google.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ "guard-robo-back" ã‚’é¸æŠ
3. Realtime Database > ä½¿ç”¨çŠ¶æ³ ã‚¿ãƒ–
4. ä»¥ä¸‹ã‚’ç¢ºèª:
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é‡ï¼ˆGB/æœˆï¼‰
   - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨é‡ï¼ˆGBï¼‰
   - åŒæ™‚æ¥ç¶šæ•°

### ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

Firebase Console ã§ä½¿ç”¨é‡ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è¨­å®š:
```
ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ > 5GB/æœˆ: ãƒ¡ãƒ¼ãƒ«é€šçŸ¥
ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ > 8GB/æœˆ: è­¦å‘Š
ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ > 9.5GB/æœˆ: ç·Šæ€¥ã‚¢ãƒ©ãƒ¼ãƒˆ
```

---

**ç¾åœ¨ã®çŠ¶æ…‹: ğŸŸ¢ æ­£å¸¸ - æœ€é©åŒ–ä¸è¦**

ä½•ã‹å•é¡ŒãŒã‚ã‚Œã°ã€ã“ã®æ–‡æ›¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚